<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Merchants Hub</title>

    <style>
        .flashes {
            list-style-type: none;
            padding: 0;
            margin-bottom: 1em;
            font-weight: bold;
        }

        .flashes .error {
            color: red;
        }

        .flashes .success {
            color: green;
        }
    </style>

</head>

<body>
    <a href="{{ url_for('map') }}"><button>⬅ Back to Map</button></a>
    <h1>Merchants Hub</h1>

    <h3>Add a new merchant</h3>
    <form action="{{ url_for('add_merchant') }}" method="post">
        <!-- Merchant Name -->
        <label for="name">Name</label>
        <input type="text" id="name" name="name" required>
    
        <!-- Level (1–10) -->
        <label for="level">Level</label>
        <select id="level" name="level" required>
            {% for lvl in range(1, 11) %}
            <option value="{{ lvl }}">{{ lvl }}</option>
            {% endfor %}
        </select>
    
        <!-- Location (enum from DB) -->
        <label for="location">Location</label>
        <select id="location" name="location" required>
            {% for loc in locations %}
            <option value="{{ loc.location }}">{{ loc.location }}</option>
            {% endfor %}
        </select>
    
        <!-- Category (enum from DB) -->
        <label for="category">Category</label>
        <select id="category" name="category" required>
            {% for cat in categories %}
            <option value="{{ cat.category }}">{{ cat.category }}</option>
            {% endfor %}
        </select>
    
        <!-- Open Hour (TIME format HH:MM:SS) -->
        <label for="hr_open">Open Hour</label>
        <select id="hr_open" name="hr_open" required>
            {% for h in range(0, 24) %}
            <option value="{{ '%02d:00:00'|format(h) }}">{{ '%02d:00'|format(h) }}</option>
            {% endfor %}
        </select>
    
        <!-- Close Hour (TIME format HH:MM:SS) -->
        <label for="hr_close">Close Hour</label>
        <select id="hr_close" name="hr_close" required>
            {% for h in range(0, 24) %}
            <option value="{{ '%02d:00:00'|format(h) }}">{{ '%02d:00'|format(h) }}</option>
            {% endfor %}
        </select>
    
        <button type="submit">Add Merchant</button>
    </form>

    <ul class="flashes">
        {% for category, msg in get_flashed_messages(with_categories=true) %}
        <li class="{{ category }}">{{ msg }}</li>
        {% endfor %}
    </ul>
    <hr>

    {% if player %}
    <h2>Player</h2>
    <ul>
        <li>
            <a href="{{ url_for('merchant_inventory', merch_id=player.merch_id) }}">
                {{ player.name }} (Level {{ player.level }})
            </a>
        </li>
    </ul>
    {% endif %}
    
    <h2>Merchants</h2>
    <ul>
        {% for merchant in merchants %}
        <li>
            <a href="{{ url_for('merchant_inventory', merch_id=merchant.merch_id) }}">
                {{ merchant.name }} (Level {{ merchant.level }})
            </a>
        </li>
        {% endfor %}
    </ul>

</body>

</html>